from astropy.io import fits
ls
biashdu = fits.open('d100.fits')
biashdu[0].header['object']
import matplotlib.pyplot as plt
plt.imshow(biashdu[0].data,cmap='gray')
plt.show()
plt.imshow(biashdu[0].data,cmap='gray')
plt.show()
plt.imshow(biashdu[0].data,cmap='gray',origin='lower')
plt.show()
import numpy as np
biasimg = biashdu[0].data
plt.imshow(biasimg,cmap='gray',origin='lower',vmin=np.min(biasimg),vmax=np.median(biasimg))
plt.show()
biasimg
biashdu[0].header['exptime']
rpsn2240hdu = fits.open('d181.fits')
rpsn2240img = rpsn2240hdu[0].data
plt.imshow(rpsn2240img,cmap='gray',origin='lower',vmin=np.median(rpsn2240img),vmax=np.median(rpsn2240img)*1.2)
plt.show()
subbias = rpsn2240img - biasimg
subbias
np.median(subbias)
plt.imshow(subbias,cmap='gray',origin='lower',vmin=50,vmax=200)
plt.show()
plt.imshow(subbias,cmap='gray',origin='lower',vmin=-50,vmax=50)
plt.show()
plt.imshow(subbias,cmap='gray',origin='lower',vmin=-50,vmax=100)
plt.show()
rpsn2240hdu[0].header['exptime']
plt.imshow(subbias,cmap='gray',origin='lower',vmin=-50,vmax=100)
plt.show()
rflthdu = fits.open('d124.fits')
rfltimg = rflthdu[0].data
plt.ion()
plt.imshow(rfltimg,cmap='gray',vmin=np.median(rfltimg),vmax=np.median(rfltimg)*1.2)
plt.imshow(rfltimg,cmap='gray',vmin=np.median(rfltimg)*0.8,vmax=np.median(rfltimg)*1.5)
flatsubbias = rfltimg - biasimg
adjustedimage = subbias/flatsubbias
adjustedimage
len(adjustedimage)
len(adjustedimage[0])
plt.imshow(adjustedimage,cmap='gray',vmin=np.median(adjustedimage),vmax=np.median(adjustedimage)*1.2)
plt.imshow(adjustedimage,cmap='gray',vmin=np.median(adjustedimage),vmax=np.median(adjustedimage)*1.2,origin='lower')
adjustedimage
np.median(adjustedimage)
hdu = fits.PrimaryHDU(adjustedimage)
hdu.writeto('example.fits')
ls
%history -f examples.txt
